<% if notice %>
  <div   class="alert text-center text-black px-4 py-2 text-[14px] absolute left-[850px] top-[80px] rounded striped-background w-max"><%= notice %></div>
<% end %>
<div class=" bg-[#F5F5F5] p-1 text-[15px] pl-4 mx-6 mb-8 text-[#39A9E8] "><span>Home</span><span class="mx-2 text-[#aba7a7]">/</span><span>Manage Class</span></div>
<div class="flex flex-wrap lg:gap-x-6 ml-6 md:mr-6 lg:mr-3 xl:mr-5 2xl:mr-3">
  <!-- profile section -->
  <div class="w-full lg:w-[55.5%]  xl:w-[57%] ">
    <div class=" container mx-auto rounded-[5px] border-2">
      <div class=" px-5 bg-[#EDEDED] flex items-center justify-between text-[#317EAC] shadow-2xl">
        <div><i class="fa-solid fa-pen-to-square"></i>
          <span class="font-semibold">Update Profile</span></div>
        <button class="accordian-header cursor-pointer text-2xl leading-0 px-1  border bg-white text-black font-extrabold rounded-3xl"> <i class="bx bx-chevron-down "></i></button>
      </div>
      <div class="accordian-body">
        <% resource_name ||= :user %>
        <% devise_mapping ||= Devise.mappings[resource_name] %>
        <%= form_for(:user, as: resource_name, url: registration_path(:user), html: { method: :put }) do |f| %>
          <div class="p-5 border-t bg-white flex-col ">
            <div class="w-full mb-4">
              <% f.email_field :email, autofocus: true, autocomplete: "email" %>
              <label for="password" class="block mb-2 text-sm font-semibold text-[#393E46] dark:text-white">Current Password</label>
              <%= f.password_field :current_password, autocomplete: "current-password", id: "user_password" , class: "bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-[5px] focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5", placeholder: "Password" %>
            </div>
            <div class="w-full mb-4">
              <label for="password" class="block mb-2 text-sm font-semibold text-[#393E46] dark:text-white">New Password</label>
              <%= f.password_field :password, autocomplete: "new-password", id: "user_password" , class: "bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-[5px] focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5", placeholder: "Password" %>
            </div>
            <div class="w-full mb-4">
              <label for="password" class="block mb-2 text-sm font-semibold text-[#393E46] dark:text-white">Confirm Password</label>
              <%= f.password_field :password_confirmation, autocomplete: "new-password", id: "confirm_password" , class: "bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-[5px] focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5", placeholder: "Password" %>
            </div>
          </div>
          <%= f.submit "Change Password",class:"text-white bg-[#39A9E8] ml-4 ml-4  md:mb-4 md:ml-5 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-semibold rounded-[5px] text-sm  w-auto sm:w-auto px-5  py-2.5 text-center" %>
        <% end %>
      </div>
    </div>
  </div>
  <!-- password form -->
  <div class="w-full lg:w-[40%]  xl:w-[40.8%] ">
    <div class=" container mx-auto rounded-[5px] border-2">
      <div class=" px-5 bg-[#EDEDED] flex items-center justify-between text-[#317EAC] shadow-2xl">
        <div><i class="fa-solid fa-pen-to-square"></i>
          <span class="font-semibold">Add Standard</span></div>
        <button class="accordian-header cursor-pointer leading-0 px-1  text-2xl  border bg-white text-black  rounded-3xl"> <i class="bx bx-chevron-down " ></i></button>
      </div>
      <div class="accordian-body">
        <%= form_for @standard, url: standards_path, method: :post do |f| %>
          <div class="p-5 border-t bg-white flex-col ">
            <div class="w-full mb-4">
              <label for="Class Name" class="block mb-2 text-sm font-semibold text-[#393E46] dark:text-white">Standard Name</label>
              <%= f.text_field :name, autocomplete: "current-password" , class: "bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-[5px] focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5", placeholder: "Password" %>
            </div>
            <div class="w-full mb-4" id="section_field">
              <%= f.fields_for :sections, f.object.sections.build do |section_form| %>
                <%= render 'section_fields', f: section_form %>
                <% end %>
                <label for="password" class="block mb-2 text-sm font-semibold text-[#393E46] dark:text-white">New Password</label>
                <%= f.password_field :password, autocomplete: "new-password", id: "user_password" , class: "bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-[5px] focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5", placeholder: "Password" %>
              </div>
              <div class="w-full mb-4">
                <label for="password" class="block mb-2 text-sm font-semibold text-[#393E46] dark:text-white">Confirm Password</label>
                <%= f.password_field :password_confirmation, autocomplete: "new-password", id: "confirm_password" , class: "bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-[5px] focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5", placeholder: "Password" %>
              </div>
            </div>
            <%= f.submit "Change Password",class:"text-white bg-[#39A9E8] ml-4 ml-4  md:mb-4 md:ml-5 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-semibold rounded-[5px] text-sm  w-auto sm:w-auto px-5  py-2.5 text-center" %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  <!-- Form for creating a new standard and multiple sections -->
  <%= form_for @standard, url: standards_path, method: :post do |f| %>
    <!-- Standard fields -->
    <%= f.label :name %>
    <%= f.text_field :name %>
    <!-- Section fields -->
    <div id="sections_fields">
      <%= f.fields_for :sections, f.object.sections.build do |section_form| %>
        <%= render 'section_fields', f: section_form %>
      <% end %>
    </div>
    <%= link_to 'Add Section', '#', id: 'add_section' %>
    <%= f.submit 'Create Standard' %>
  <% end %>
  <!-- Partial for section fields -->
  <!-- app/views/standards/_section_fields.html.erb -->
  <%# // app/views/standards/index.html.erb %>
  <script>
    $(document).ready(function() {
      // Counter to track the number of section fields
      var sectionIndex = <%= @standard.sections.size %>;
      console.log(sectionIndex);
      // Add Section button click event
      $('#add_section').click(function(e) {
        e.preventDefault();
        addSectionField();
      });

      // Remove Section button click event
      $('#sections_fields').on('click', '.remove_section', function(e) {
        e.preventDefault();
        $(this).closest('.section_fields').remove();
      });

      // Function to add a new section field
      function addSectionField() {
        var newSectionField = $('#sections_fields .section_fields:first').clone();
        newSectionField.find('input').val('');

        // Update field names with unique indices
        newSectionField.find('input').each(function() {
          var oldName = $(this).attr('name');
          var newName = oldName.replace(/\[\d\]/, '[' + sectionIndex + ']');
          $(this).attr('name', newName);
        });

        $('#sections_fields').append(newSectionField);
        sectionIndex++;
      }
    });
  </script>
